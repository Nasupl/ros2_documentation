# SOME DESCRIPTIVE TITLE.
# Copyright (C) 2018, Open Robotics
# This file is distributed under the same license as the ros2 documentation
# package.
# FIRST AUTHOR <EMAIL@ADDRESS>, 2021.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: ros2 documentation \n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2021-06-22 13:26+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=utf-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Generated-By: Babel 2.9.1\n"

#: ../../source/Guides/DDS-tuning.rst:6
msgid "DDS tuning information"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:8
msgid ""
"This page provides some guidance on parameter tunings that were found to "
"address issues faced while using various DDS implementations on Linux in "
"real-world situations. It is possible that the issues we identified on "
"Linux or while using one vendor may occur for other platforms and vendors"
" not documented here."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:11
msgid ""
"The recommendations below are starting points for tuning; they worked for"
" specific systems and environments, but the tuning may vary depending on "
"a number of factors. You may need to increase or decrease values while "
"debugging relative to factors like message size, network topology, etc."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:14
msgid ""
"It is important to recognize that tuning parameters can come at a cost to"
" resources, and may affect parts of your system beyond the scope of the "
"desired improvements. The benefits of improving reliability should be "
"weighed against any detriments for each individual case."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:20
msgid "Cross-vendor tuning"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:22
msgid ""
"**Issue:** Sending data over lossy (usually WiFi) connections becomes "
"problematic when some IP fragments are dropped, possibly causing the "
"kernel buffer on the receiving side to become full."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:24
msgid ""
"When a UDP packet is missing at least one IP fragment, the rest of the "
"received fragments fill up the kernel buffer. By default, the Linux "
"kernel will time out after 30s of trying to recombine packet fragments. "
"Since the kernel buffer is full at this point (default size is 256KB), no"
" new fragments can come in, and so the connection will seemingly \"hang\""
" for long periods of time."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:28
msgid ""
"This issue is generic across all DDS vendors, so the solutions involve "
"adjusting kernel parameters."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:30
msgid "**Solution:** Use best-effort QoS settings instead of reliable."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:32
msgid ""
"Best-effort settings reduce the amount of network traffic since the DDS "
"implementation does not have to incur the overhead of reliable "
"communications, where publishers require acknowledgements for messages "
"sent to subscribers and must resend samples that have not been properly "
"received."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:34
msgid ""
"If the kernel buffer for IP fragments gets full, though, the symptom is "
"still the same (blocking for 30s). This solution should improve the issue"
" somewhat without having to adjust parameters."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:37
msgid "**Solution:** Reduce the value of the ``ipfrag_time`` parameter."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:39
msgid ""
"``net.ipv4.ipfrag_time / /proc/sys/net/ipv4/ipfrag_time`` (default 30s) :"
" Time in seconds to keep an IP fragment in memory."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:42
msgid "Reduce the value, for example, to 3s, by running:"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:48
msgid ""
"Reducing this parameter’s value also reduces the window of time where no "
"fragments are received. The parameter is global for all incoming "
"fragments, so the feasibility of reducing its value needs to be "
"considered for every environment."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:51
msgid "**Solution:** Increase the value of the ``ipfrag_high_thresh`` parameter."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:53
msgid ""
"``net.ipv4.ipfrag_high_thresh / /proc/sys/net/ipv4/ipfrag_high_thresh`` "
"(default: 262144 bytes): Maximum memory used to reassemble IP fragments."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:56
msgid "Increase the value, for example, to 128MB, by running:"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:62
msgid ""
"Significantly increasing this parameter’s value is an attempt to ensure "
"that the buffer never becomes completely full. However, the value would "
"likely have to be significantly high to hold all data received during the"
" time window of ``ipfrag_time``, assuming every UDP packet lacks one "
"fragment."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:66
msgid "Fast RTPS tuning"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:68
msgid ""
"**Issue:** Fast RTPS floods the network with large pieces of data or "
"fast-published data when operating over WiFi."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:70
msgid "See the solutions under :ref:`Cross-vendor tuning <cross-vendor-tuning>`."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:73
msgid "Cyclone DDS tuning"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:75
msgid ""
"**Issue:** Cyclone DDS is not delivering large messages reliably, despite"
" using reliable settings and transferring over a wired network."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:77
msgid ""
"This issue should be `addressed soon <https://github.com/eclipse-"
"cyclonedds/cyclonedds/issues/484>`_. Until then, we’ve come up with the "
"following solution (debugged using `this test program "
"<https://github.com/jacobperron/pc_pipe>`_):"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:80
msgid ""
"**Solution:** Increase the maximum Linux kernel receive buffer size and "
"the minimum socket receive buffer size that Cyclone uses."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:82
msgid "*Adjustments to solve for a 9MB message:*"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:84 ../../source/Guides/DDS-tuning.rst:123
msgid "Set the maximum receive buffer size, ``rmem_max``, by running:"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:90
msgid ""
"Or permanently set it by editing the ``/etc/sysctl.d/10-cyclone-"
"max.conf`` file to contain:"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:96
msgid ""
"Next, to set the minimum socket receive buffer size that Cyclone "
"requests, write out a configuration file for Cyclone to use while "
"starting, like so:"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:110
msgid ""
"Then, whenever you are going to run a node, set the following environment"
" variable:"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:117
msgid "RTI Connext tuning"
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:119
msgid ""
"**Issue:** Connext is not delivering large messages reliably, despite "
"using reliable settings and transferring over a wired network."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:121
msgid ""
"**Solution:** This `Connext QoS profile "
"<https://github.com/jacobperron/pc_pipe/blob/master/etc/ROS2TEST_QOS_PROFILES.xml>`_,"
" along with increasing the ``rmem_max`` parameter."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:129
msgid ""
"By tuning ``net.core.rmem_max`` to 4MB in the Linux kernel, the QoS "
"profile can produce truly reliable behavior."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:131
msgid ""
"This configuration has been proven to reliably deliver messages via "
"SHMEM|UDPv4, and with just UDPv4 on a single machine. A multi-machine "
"configuration was also tested with ``rmem_max`` at 4MB and at 20MB (two "
"machines connected with 1Gbps ethernet), with no dropped messages and "
"average message delivery times of 700ms and 371ms, respectively."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:134
msgid ""
"Without configuring the kernel’s ``rmem_max``, the same Connext QoS "
"profile took up to 12 seconds for the data to be delivered. However, it "
"always at least managed to complete the delivery."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:137
msgid ""
"**Solution:** Use the `Connext QoS profile "
"<https://github.com/jacobperron/pc_pipe/blob/master/etc/ROS2TEST_QOS_PROFILES.xml>`_"
" *without* adjusting ``rmem_max``."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:139
msgid ""
"The ROS2TEST_QOS_PROFILES.xml file was configured using RTI’s "
"documentation on `configuring flow controllers <https://community.rti.com"
"/forum-topic/transfering-large-data-over-dds>`_. It has slow, medium and "
"fast flow controllers (seen in the Connext QoS profile link)."
msgstr ""

#: ../../source/Guides/DDS-tuning.rst:141
msgid ""
"The medium flow controller produced the best results for our case. "
"However, the controllers will still need to be tuned for the particular "
"machine/network/environment they are operating in. The Connext flow "
"controllers can be used to tune bandwidth and its aggressiveness for "
"sending out data, though once the bandwidth of a particular setup is "
"passed, performance will start to drop."
msgstr ""

